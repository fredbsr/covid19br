---
title: 'O medo da morte flexibiliza perdas'
subtitle: Consequências políticas da pandemia da Covid-19 no Brasil
author: 
 - Carlos Pereira (FGV) 
 - Amanda Medeiros (FGV) 
 - Frederico Bertholini (UnB)
date: "Abril, 2020"
output:
  
  revealjs::revealjs_presentation:
    
    theme: night
    transition: slide
    navigationMode: linear
    self_contained: true
    css: slides.css
editor_options:
  chunk_output_type: console

---

```{r setup, include=FALSE,warning=F,message=F}
knitr::opts_chunk$set(echo = FALSE,
                      fig.margin=TRUE,
                      warning = F,
                      message = F#,
                  #    fig.height=4,
                  #    fig.width=6.8,
                  #    fig.align = 'center'
                  )

lista.de.pacotes = c("tidyverse","haven","lubridate","janitor","readxl",
                     "stringr","repmis","pander",
                     #"srvyr","ggstatsplot",
                     "flextable","compareGroups",
                     "magrittr","ggridges","ggpubr","ggdark",
                     "hrbrthemes","viridis","extrafont",
                     "dabestr","patchwork") # escreva a lista de pacotes

novos.pacotes <- lista.de.pacotes[!(lista.de.pacotes %in%
                                      installed.packages()[,"Package"])]
if(length(novos.pacotes) > 0) {install.packages(novos.pacotes)}
lapply(lista.de.pacotes, require, character.only=T)
rm(lista.de.pacotes,novos.pacotes)
gc()

loadfonts()

# Rodando o namespace
load("data.RData")

```


# {.right}

<br>
<br>
“Quem é você?<br>
<amar>Eu sou a morte.</amar><br>
Você veio me buscar?<br> 
<amar>Eu tenho acompanhado você há muito tempo...</amar><br>
Eu sei.<br>
<amar>Você está preparado? </amar><br>
Meu corpo está, mas eu não estou.<br>
<amar>Espere um instante.</amar><br>
Todos vocês dizem isso, mas não há trégua.”<br>
<br>
<bold>O Sétimo Selo,<br> <yt>Ingmar Bergman</yt> (1956)</bold>

# Questões de interesse

Choque Exógeno: COVID-19 <br>
- <amar>Altera o eixo da polarização?</amar> (isolamento social)

<yt>Dimensão 1: Ideologia</yt>
<p class="center">
Bolsonaro > consequências econômicas <br>
vs.<br>
Governadores > riscos à saúde
</p>

<yt>Dimensão 2: Renda</yt>
<p class="center">
Ricos > a favor do isolamento <br>
vs.<br>
Pobres > contra o isolamento
</p>

# Novos eixos da polarização ideológica

- Consenso do Centro à Esquerda: <yt>a favor do isolamento e contra as ações do Presidente</yt>.

- A <amar>direita</amar>, porém, está <amar>dividida</amar>!


## Avaliação sobre o isolamento por ideologia {.center}

```{r}


a <- df %>%
  ggplot() +
  geom_density_ridges(
                      aes(y=ideologia_cat,
                          fill=ideologia_cat,
                          x=favor_isol),
                     # fill="grey50",
                      color=NA,
                      scale=.9) +
   geom_segment(data=. %>%
                   group_by(var=ideologia_cat) %>%
                   summarise( n=n(),mean=mean(favor_isol),sd=sd(favor_isol)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
               aes(y = as.numeric(var),
                   yend = as.numeric(var) + .6,
                   x=mean,
                   xend=mean),
               color="white",
               size=1) +
  geom_rect(data=. %>%
                   group_by(var=ideologia_cat) %>%
                   summarise( n=n(),mean=mean(favor_isol),sd=sd(favor_isol)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
            aes(ymin = as.numeric(var),
                ymax = as.numeric(var) + .6,
                xmin=ci_mean_low,
                xmax=ci_mean_hi),
            fill="white",
            alpha=0.25) +
  geom_label(data=. %>%
                   group_by(var=ideologia_cat) %>%
                   summarise( n=n(),mean=mean(favor_isol),sd=sd(favor_isol)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
             aes(label=paste("Média",
                             sprintf("%1.1f", mean),
                             "\u00b1",
                             sprintf("%1.1f", ic)),
                 x=mean,
                 fill=var,
                 y=var), 
             position=position_nudge(y=.65), 
           #  fill="white", 
             color="white",
             size=4,
             fontface="bold",
             family = "Lato",
             alpha=0.75) +
  
   scale_x_continuous(breaks = c(1,3,5),
                     labels=c("Totalmente\nContrário (1)",
                              "Indiferente (3)",
                              "Totalmente\nFavorável (5)")) +
  scale_y_discrete(expand = expansion(mult = c(0, .2))) +
  labs(y="Ideologia",
       #title="",
       x="Posição sobre Isolamento (escala de 1 a 5)") +
#  theme_ridges() +
  scale_fill_manual(values = paleta) +
  scale_color_manual(values = paleta) +
  dark_theme_void() +
  theme(legend.position = "none",
        panel.grid.major.x = element_blank(),
        axis.title = element_text(size=10),
        axis.title.y = element_text(angle = 90,hjust = 1),
        axis.text.y = element_text(size=12),
        axis.text.x = element_text(face = "bold",size = 11),
        plot.title = element_text(size=11))

b <- df %>%
  ggplot() +
  geom_density_ridges(
                      aes(y=ideologia_cat,
                          fill=ideologia_cat,
                          x=time),
                    #  fill="grey50",
                      color=NA,
                      scale=.99) +
   geom_segment(data=. %>%
                   group_by(var=ideologia_cat) %>%
                   summarise( n=n(),mean=mean(time),sd=sd(time)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
               aes(y = as.numeric(var),
                   yend = as.numeric(var) + .6,
                   x=mean,
                   xend=mean),
               color="white",
               size=1) +
  geom_rect(data=. %>%
                   group_by(var=ideologia_cat) %>%
                   summarise( n=n(),mean=mean(time),sd=sd(time)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
            aes(ymin = as.numeric(var),
                ymax = as.numeric(var) + .6,
                xmin=ci_mean_low,
                xmax=ci_mean_hi),
            fill="white",
            alpha=0.25) +
  geom_label(data=. %>%
                   group_by(var=ideologia_cat) %>%
                   summarise( n=n(),mean=mean(time),sd=sd(time)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
             aes(label=paste("Média",
                             sprintf("%1.1f", mean),
                             "\u00b1",
                             sprintf("%1.1f", ic)),
                 x=mean,
                 fill=var,
                 y=var), 
             position=position_nudge(y=.65), 
           #  fill="white", 
             color="white",
             size=3,
             fontface="bold",
             family = "Lato",
             alpha=0.75) +
    scale_fill_manual(values = c("#262833",
                               "#4ACFAC",
                               "#7EBCED",
                               "#36C7D0",
                               "#FFA48E")) +
  scale_color_manual(values = c("#262833",
                               "#4ACFAC",
                               "#7EBCED",
                               "#36C7D0",
                               "#FFA48E")) +
  scale_y_discrete(expand = expansion(mult = c(0, .2))) +
  scale_x_continuous(breaks = c(1,7),
                     labels=c("Nem mais\n um dia (1)","Pelo tempo \nnecessário (7)")) +
  labs(y="",x="Posição sobre o tempo \n de isolamento") +
#  theme_ridges() +
  dark_theme_void() +
  theme(legend.position = "none",
        axis.title = element_text(size=10),
        axis.text = element_text(size=9),
        axis.text.y = element_blank(),
        plot.title = element_text(size=11)) +
  guides(colour = "none")

p1 <- (a | b) + plot_layout(guides = 'collect')

a & theme(legend.position = "none",
          legend.title = element_blank(),
          legend.text = element_text(size=8),
        axis.title = element_text(size=11),
        plot.margin = margin(0, 0, 0, 0, "cm"),
      #  axis.text.y = element_blank(),
      panel.grid.major.x = element_line(linetype = "dotted"),
        plot.title = element_text(size=10,hjust=.5),
      text = element_text(family = "Lato") )
```


## Avaliação sobre o tempo de isolamento por ideologia {.center}

```{r}
b & theme(legend.position = "none",
          legend.title = element_blank(),
          legend.text = element_text(size=8),
        axis.title = element_text(size=11),
        plot.margin = margin(0, 0, 0, 0, "cm"),
      #  axis.text.y = element_blank(),
      panel.grid.major.x = element_line(linetype = "dotted"),
        plot.title = element_text(size=10,hjust=.5),
      text = element_text(family = "Lato") )
```


## Avaliação sobre as ações do Presidente {.center}

```{r}

c <- df %>%
  ggplot() +
  geom_density_ridges(
                      aes(y=ideologia_cat,
                          fill=ideologia_cat,
                          x=trabbolso),
                      #fill="grey25",
                      color=NA,
                      scale=.99) +
   geom_segment(data=. %>%
                   group_by(var=ideologia_cat) %>%
                   summarise( n=n(),mean=mean(trabbolso),sd=sd(trabbolso)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
               aes(y = as.numeric(var),
                   yend = as.numeric(var) + .9,
                   x=mean,
                   xend=mean),
               color="white",
               size=1) +
  geom_rect(data=. %>%
                   group_by(var=ideologia_cat) %>%
                   summarise( n=n(),mean=mean(trabbolso),sd=sd(trabbolso)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
            aes(ymin = as.numeric(var),
                ymax = as.numeric(var) + .9,
                xmin=ci_mean_low,
                xmax=ci_mean_hi),
            fill="white",
            alpha=0.25) +
  geom_label(data=. %>%
                   group_by(var=ideologia_cat) %>%
                   summarise( n=n(),mean=mean(trabbolso),sd=sd(trabbolso)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
             aes(label=paste("Média",
                             sprintf("%1.1f", mean),
                             "\u00b1",
                             sprintf("%1.1f", ic)),
                 x=mean,
                 y=var,
                 fill=var), 
             position=position_nudge(y=.75), 
         #    fill="white", 
             color="white",
             size=3,
             #fontface="bold",
             family = "Lato",
             alpha=0.75) +
  
   scale_x_continuous(breaks = c(1,3,5),
                     labels=c("Totalmente\nContrário (1)",
                              "Indiferente (3)",
                              "Totalmente\nFavorável (5)")) +
  scale_y_discrete(expand = expansion(mult = c(0, .2))) +
  labs(y="Ideologia",
       #title="",
       x="Posição sobre as ações do\n Presidente (escala de 1 a 5)") +
  #theme_ridges() +
  dark_theme_void() +
  theme(legend.position = "none",
        panel.grid.major.x = element_blank(),
        axis.title = element_text(size=10),
        axis.text = element_text(size=8),
        axis.text.x = element_text(face = "bold"),
        plot.title = element_text(size=11))



d <- df %>%
  ggplot() +
  geom_density_ridges(
                      aes(y=ideologia_cat,
                          x=trabgov,
                          fill=ideologia_cat),
                   #   fill="grey25",
                      color=NA,
                      scale=.99) +
   geom_segment(data=. %>%
                   group_by(var=ideologia_cat) %>%
                   summarise( n=n(),mean=mean(trabgov),sd=sd(trabgov)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
               aes(y = as.numeric(var),
                   yend = as.numeric(var) + .9,
                   x=mean,
                   xend=mean),
               color="white",
               size=1) +
  geom_rect(data=. %>%
                   group_by(var=ideologia_cat) %>%
                   summarise( n=n(),mean=mean(trabgov),sd=sd(trabgov)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
            aes(ymin = as.numeric(var),
                ymax = as.numeric(var) + .9,
                xmin=ci_mean_low,
                xmax=ci_mean_hi),
            fill="white",
            alpha=0.25) +
  geom_label(data=. %>%
                   group_by(var=ideologia_cat) %>%
                   summarise( n=n(),mean=mean(trabgov),sd=sd(trabgov)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
             aes(label=paste("Média",
                             sprintf("%1.1f", mean),
                             "\u00b1",
                             sprintf("%1.1f", ic)),
                 x=mean,
                  y=var,
                 fill=var), 
             position=position_nudge(y=.75), 
         #    fill="white", 
             color="white",
             size=3,
             #fontface="bold",
             family = "Lato",
             alpha=0.75) +
  
   scale_x_continuous(breaks = c(1,3,5),
                     labels=c("Totalmente\nContrário (1)",
                              "Indiferente (3)",
                              "Totalmente\nFavorável (5)")) +
  scale_y_discrete(expand = expansion(mult = c(0, .2))) +
  labs(y="",
       #title="",
       x="Posição sobre as ações dos\n Governadores (escala de 1 a 5)") +
  #theme_ridges() +
  dark_theme_void() +
  theme(legend.position = "none",
        panel.grid.major.x = element_blank(),
        axis.title = element_text(size=10),
        axis.text = element_text(size=9),
        axis.text.x = element_text(face = "bold"),
        axis.text.y = element_blank(),
        plot.title = element_text(size=11))


p2 <- (c | d) + 
  plot_layout(guides = 'collect')

c & 
  theme(legend.position = "none",
          legend.title = element_blank(),
          legend.text = element_text(size=8),
          axis.text.x = element_text(size=8),
        axis.title = element_text(size=9),
         plot.margin = margin(0, 0, 0, 0, "cm"),
    #    axis.text.y = element_blank(),
      panel.grid.major.x = element_line(linetype = "dotted"),
        plot.title = element_text(size=10,hjust=.5),
    panel.border = element_blank(),
    
      text = element_text(family = "Lato") ) 
```


## Avaliação sobre as ações dos Governadores {.center}

```{r}
d & 
  theme(legend.position = "none",
          legend.title = element_blank(),
          legend.text = element_text(size=8),
          axis.text.x = element_text(size=8),
        axis.title = element_text(size=9),
         plot.margin = margin(0, 0, 0, 0, "cm"),
    #    axis.text.y = element_blank(),
      panel.grid.major.x = element_line(linetype = "dotted"),
        plot.title = element_text(size=10,hjust=.5),
    panel.border = element_blank(),
    
      text = element_text(family = "Lato") ) 
```

## {.center}

<h1> O que explica esse comportamento? </h1>


# O espectro da morte 

- À medida que os indivíduos tomam conhecimento de vítimas fatais em seu convívio próximo, as coisas começam a mudar.


## Avaliação sobre o isolamento {.center}

```{r}


a <- df %>%
  ggplot() +
  geom_density_ridges(
                      aes(y=coron_cat,
                          fill=coron_cat,
                          x=favor_isol),
                     # fill="grey50",
                      color=NA,
                      scale=.9) +
   geom_segment(data=. %>%
                   group_by(var=coron_cat) %>%
                   summarise( n=n(),mean=mean(favor_isol),sd=sd(favor_isol)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
               aes(y = as.numeric(var),
                   yend = as.numeric(var) + .6,
                   x=mean,
                   xend=mean),
               color="white",
               size=1) +
  geom_rect(data=. %>%
                   group_by(var=coron_cat) %>%
                   summarise( n=n(),mean=mean(favor_isol),sd=sd(favor_isol)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
            aes(ymin = as.numeric(var),
                ymax = as.numeric(var) + .6,
                xmin=ci_mean_low,
                xmax=ci_mean_hi),
            fill="white",
            alpha=0.25) +
  geom_label(data=. %>%
                   group_by(var=coron_cat) %>%
                   summarise( n=n(),mean=mean(favor_isol),sd=sd(favor_isol)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
             aes(label=paste("Média",
                             sprintf("%1.1f", mean),
                             "\u00b1",
                             sprintf("%1.1f", ic)),
                 x=mean,
                 fill=var,
                 y=var), 
             position=position_nudge(y=.65), 
           #  fill="white", 
             color="white",
             size=4,
             fontface="bold",
             family = "Lato",
             alpha=0.75) +
  
   scale_x_continuous(breaks = c(1,3,5),
                     labels=c("Totalmente\nContrário (1)",
                              "Indiferente (3)",
                              "Totalmente\nFavorável (5)")) +
  scale_y_discrete(expand = expansion(mult = c(0, .2))) +
  labs(y="Ideologia",
       #title="",
       x="Posição sobre Isolamento (escala de 1 a 5)") +
#  theme_ridges() +
  scale_fill_manual(values = paleta) +
  scale_color_manual(values = paleta) +
  dark_theme_void() +
  theme(legend.position = "none",
        panel.grid.major.x = element_blank(),
        axis.title = element_text(size=10),
        axis.title.y = element_text(angle = 90,hjust = 1),
        axis.text.y = element_text(size=12),
        axis.text.x = element_text(face = "bold",size = 11),
        plot.title = element_text(size=11))

b <- df %>%
  ggplot() +
  geom_density_ridges(
                      aes(y=coron_cat,
                          fill=coron_cat,
                          x=time),
                    #  fill="grey50",
                      color=NA,
                      scale=.99) +
   geom_segment(data=. %>%
                   group_by(var=coron_cat) %>%
                   summarise( n=n(),mean=mean(time),sd=sd(time)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
               aes(y = as.numeric(var),
                   yend = as.numeric(var) + .6,
                   x=mean,
                   xend=mean),
               color="white",
               size=1) +
  geom_rect(data=. %>%
                   group_by(var=coron_cat) %>%
                   summarise( n=n(),mean=mean(time),sd=sd(time)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
            aes(ymin = as.numeric(var),
                ymax = as.numeric(var) + .6,
                xmin=ci_mean_low,
                xmax=ci_mean_hi),
            fill="white",
            alpha=0.25) +
  geom_label(data=. %>%
                   group_by(var=coron_cat) %>%
                   summarise( n=n(),mean=mean(time),sd=sd(time)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
             aes(label=paste("Média",
                             sprintf("%1.1f", mean),
                             "\u00b1",
                             sprintf("%1.1f", ic)),
                 x=mean,
                 fill=var,
                 y=var), 
             position=position_nudge(y=.65), 
           #  fill="white", 
             color="white",
             size=3,
             fontface="bold",
             family = "Lato",
             alpha=0.75) +
    scale_fill_manual(values = c("#262833",
                               "#4ACFAC",
                               "#7EBCED",
                               "#36C7D0",
                               "#FFA48E")) +
  scale_color_manual(values = c("#262833",
                               "#4ACFAC",
                               "#7EBCED",
                               "#36C7D0",
                               "#FFA48E")) +
  scale_y_discrete(expand = expansion(mult = c(0, .2))) +
  scale_x_continuous(breaks = c(1,7),
                     labels=c("Nem mais\n um dia (1)","Pelo tempo \nnecessário (7)")) +
  labs(y="",x="Posição sobre o tempo \n de isolamento") +
#  theme_ridges() +
  dark_theme_void() +
  theme(legend.position = "none",
        axis.title = element_text(size=10),
        axis.text = element_text(size=9),
        axis.text.y = element_blank(),
        plot.title = element_text(size=11)) +
  guides(colour = "none")

p1 <- (a | b) + plot_layout(guides = 'collect')

a & theme(legend.position = "none",
          legend.title = element_blank(),
          legend.text = element_text(size=8),
        axis.title = element_text(size=11),
        plot.margin = margin(0, 0, 0, 0, "cm"),
      #  axis.text.y = element_blank(),
      panel.grid.major.x = element_line(linetype = "dotted"),
        plot.title = element_text(size=10,hjust=.5),
      text = element_text(family = "Lato") )
```


## Avaliação sobre o tempo de isolamento por ideologia {.center}

```{r}
b & theme(legend.position = "none",
          legend.title = element_blank(),
          legend.text = element_text(size=8),
        axis.title = element_text(size=11),
        plot.margin = margin(0, 0, 0, 0, "cm"),
      #  axis.text.y = element_blank(),
      panel.grid.major.x = element_line(linetype = "dotted"),
        plot.title = element_text(size=10,hjust=.5),
      text = element_text(family = "Lato") )
```


## Avaliação sobre as ações do Presidente {.center}

```{r}

c <- df %>%
  ggplot() +
  geom_density_ridges(
                      aes(y=coron_cat,
                          fill=coron_cat,
                          x=trabbolso),
                      #fill="grey25",
                      color=NA,
                      scale=.99) +
   geom_segment(data=. %>%
                   group_by(var=coron_cat) %>%
                   summarise( n=n(),mean=mean(trabbolso),sd=sd(trabbolso)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
               aes(y = as.numeric(var),
                   yend = as.numeric(var) + .9,
                   x=mean,
                   xend=mean),
               color="white",
               size=1) +
  geom_rect(data=. %>%
                   group_by(var=coron_cat) %>%
                   summarise( n=n(),mean=mean(trabbolso),sd=sd(trabbolso)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
            aes(ymin = as.numeric(var),
                ymax = as.numeric(var) + .9,
                xmin=ci_mean_low,
                xmax=ci_mean_hi),
            fill="white",
            alpha=0.25) +
  geom_label(data=. %>%
                   group_by(var=coron_cat) %>%
                   summarise( n=n(),mean=mean(trabbolso),sd=sd(trabbolso)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
             aes(label=paste("Média",
                             sprintf("%1.1f", mean),
                             "\u00b1",
                             sprintf("%1.1f", ic)),
                 x=mean,
                 y=var,
                 fill=var), 
             position=position_nudge(y=.75), 
         #    fill="white", 
             color="white",
             size=3,
             #fontface="bold",
             family = "Lato",
             alpha=0.75) +
  
   scale_x_continuous(breaks = c(1,3,5),
                     labels=c("Totalmente\nContrário (1)",
                              "Indiferente (3)",
                              "Totalmente\nFavorável (5)")) +
  scale_y_discrete(expand = expansion(mult = c(0, .2))) +
  labs(y="Ideologia",
       #title="",
       x="Posição sobre as ações do\n Presidente (escala de 1 a 5)") +
  #theme_ridges() +
  dark_theme_void() +
  theme(legend.position = "none",
        panel.grid.major.x = element_blank(),
        axis.title = element_text(size=10),
        axis.text = element_text(size=8),
        axis.text.x = element_text(face = "bold"),
        plot.title = element_text(size=11))



d <- df %>%
  ggplot() +
  geom_density_ridges(
                      aes(y=coron_cat,
                          x=trabgov,
                          fill=coron_cat),
                   #   fill="grey25",
                      color=NA,
                      scale=.99) +
   geom_segment(data=. %>%
                   group_by(var=coron_cat) %>%
                   summarise( n=n(),mean=mean(trabgov),sd=sd(trabgov)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
               aes(y = as.numeric(var),
                   yend = as.numeric(var) + .9,
                   x=mean,
                   xend=mean),
               color="white",
               size=1) +
  geom_rect(data=. %>%
                   group_by(var=coron_cat) %>%
                   summarise( n=n(),mean=mean(trabgov),sd=sd(trabgov)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
            aes(ymin = as.numeric(var),
                ymax = as.numeric(var) + .9,
                xmin=ci_mean_low,
                xmax=ci_mean_hi),
            fill="white",
            alpha=0.25) +
  geom_label(data=. %>%
                   group_by(var=coron_cat) %>%
                   summarise( n=n(),mean=mean(trabgov),sd=sd(trabgov)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
             aes(label=paste("Média",
                             sprintf("%1.1f", mean),
                             "\u00b1",
                             sprintf("%1.1f", ic)),
                 x=mean,
                  y=var,
                 fill=var), 
             position=position_nudge(y=.75), 
         #    fill="white", 
             color="white",
             size=3,
             #fontface="bold",
             family = "Lato",
             alpha=0.75) +
  
   scale_x_continuous(breaks = c(1,3,5),
                     labels=c("Totalmente\nContrário (1)",
                              "Indiferente (3)",
                              "Totalmente\nFavorável (5)")) +
  scale_y_discrete(expand = expansion(mult = c(0, .2))) +
  labs(y="",
       #title="",
       x="Posição sobre as ações dos\n Governadores (escala de 1 a 5)") +
  #theme_ridges() +
  dark_theme_void() +
  theme(legend.position = "none",
        panel.grid.major.x = element_blank(),
        axis.title = element_text(size=10),
        axis.text = element_text(size=9),
        axis.text.x = element_text(face = "bold"),
        axis.text.y = element_blank(),
        plot.title = element_text(size=11))


p2 <- (c | d) + 
  plot_layout(guides = 'collect')

c & 
  theme(legend.position = "none",
          legend.title = element_blank(),
          legend.text = element_text(size=8),
          axis.text.x = element_text(size=8),
        axis.title = element_text(size=9),
         plot.margin = margin(0, 0, 0, 0, "cm"),
    #    axis.text.y = element_blank(),
      panel.grid.major.x = element_line(linetype = "dotted"),
        plot.title = element_text(size=10,hjust=.5),
    panel.border = element_blank(),
    
      text = element_text(family = "Lato") ) 
```


## Avaliação sobre as ações dos Governadores {.center}

```{r}
d & 
  theme(legend.position = "none",
          legend.title = element_blank(),
          legend.text = element_text(size=8),
          axis.text.x = element_text(size=8),
        axis.title = element_text(size=9),
         plot.margin = margin(0, 0, 0, 0, "cm"),
    #    axis.text.y = element_blank(),
      panel.grid.major.x = element_line(linetype = "dotted"),
        plot.title = element_text(size=10,hjust=.5),
    panel.border = element_blank(),
    
      text = element_text(family = "Lato") ) 
```

# Isolamento é coisa de rico?

- Renda não tem relevância, mas o <amra>prejuízo econômico esperado</amar>, sim.

## Definitivamente, não!

```{r}
## Grafico padrão - transformar em função ##
drt.df %>%
  dplyr::filter(!is.na(renda_cat)) %>%
  ggplot() +
  geom_density_ridges(
                     aes(y=renda_cat,
                         fill=renda_cat,
                          x=trabbolso),
                    
                      color=NA,
                      scale=.9) +
   geom_segment(data=. %>%
                   group_by(var=renda_cat) %>%
                   summarise( n=n(),mean=mean(trabbolso),sd=sd(trabbolso)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
               aes(y = as.numeric(var),
                   yend = as.numeric(var) + .6,
                   x=mean,
                   xend=mean),
               color="white",
               size=1) +
  geom_rect(data=. %>%
                   group_by(var=renda_cat) %>%
                   summarise( n=n(),mean=mean(trabbolso),sd=sd(trabbolso)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
            aes(ymin = as.numeric(var),
                ymax = as.numeric(var) + .6,
                xmin=ci_mean_low,
                xmax=ci_mean_hi),
            fill="white",
            alpha=0.25) +
  geom_label(data=. %>%
                   group_by(var=renda_cat) %>%
                   summarise( n=n(),mean=mean(trabbolso),sd=sd(trabbolso)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
             aes(label=paste("Média",
                             sprintf("%1.1f", mean),
                             "\u00b1",
                             sprintf("%1.1f", ic)),
                 x=mean,
                 fill=var,
                 y=var), 
             position=position_nudge(y=.65), 
           #  fill="white", 
             color="white",
             size=4,
             fontface="bold",
             family = "Lato",
             alpha=0.75) +
  
   scale_x_continuous(breaks = c(1,3,5),
                     labels=c("Totalmente\nContrário (1)",
                              "Indiferente (3)",
                              "Totalmente\nFavorável (5)")) +
  scale_y_discrete(expand = expansion(mult = c(0, .2))) +
  labs(y="",
       #title="",
       x="Posição sobre as ações do Presidente (escala de 1 a 5)") +
#  theme_ridges() +
  scale_fill_manual(values = paleta) +
  scale_color_manual(values = paleta) +
  dark_theme_void() +
  theme(legend.position = "none",
        panel.grid.major.x = element_blank(),
        axis.title = element_text(size=10),
        axis.title.y = element_blank(),
        axis.text.y = element_text(size=12),
        axis.text.x = element_text(face = "bold",size = 11),
        plot.title = element_text(size=11))


```


## Prejuízo econômico {.center}

```{r}
## Grafico padrão - transformar em função ##
drt.df%>%
  dplyr::filter(!is.na(prejuizo)) %>%
  ggplot() +
  geom_density_ridges(
                     aes(y=prejuizo,
                         fill=prejuizo,
                          x=trabbolso),
                    
                      color=NA,
                      scale=.9) +
   geom_segment(data=. %>%
                   group_by(var=prejuizo) %>%
                   summarise( n=n(),mean=mean(trabbolso),sd=sd(trabbolso)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
               aes(y = as.numeric(var),
                   yend = as.numeric(var) + .6,
                   x=mean,
                   xend=mean),
               color="white",
               size=1) +
  geom_rect(data=. %>%
                   group_by(var=prejuizo) %>%
                   summarise( n=n(),mean=mean(trabbolso),sd=sd(trabbolso)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
            aes(ymin = as.numeric(var),
                ymax = as.numeric(var) + .6,
                xmin=ci_mean_low,
                xmax=ci_mean_hi),
            fill="white",
            alpha=0.25) +
  geom_label(data=. %>%
                   group_by(var=prejuizo) %>%
                   summarise( n=n(),mean=mean(trabbolso),sd=sd(trabbolso)) %>%
                   mutate(se=sd/sqrt(n),ic=se * qt((1-0.01)/2 + .5, n-1),
                          ci_mean_hi=mean+ic,
                          ci_mean_low=mean-ic) %>%
                          dplyr::filter(!is.na(var)),
             aes(label=paste("Média",
                             sprintf("%1.1f", mean),
                             "\u00b1",
                             sprintf("%1.1f", ic)),
                 x=mean,
                 fill=var,
                 y=var), 
             position=position_nudge(y=.65), 
           #  fill="white", 
             color="white",
             size=4,
             fontface="bold",
             family = "Lato",
             alpha=0.75) +
  
   scale_x_continuous(breaks = c(1,3,5),
                     labels=c("Totalmente\nContrário (1)",
                              "Indiferente (3)",
                              "Totalmente\nFavorável (5)")) +
  scale_y_discrete(expand = expansion(mult = c(0, .2))) +
  labs(y="",
       #title="",
       x="Posição sobre as ações do Presidente (escala de 1 a 5)") +
#  theme_ridges() +
  scale_fill_manual(values = paleta) +
  scale_color_manual(values = paleta) +
  dark_theme_void() +
  theme(legend.position = "none",
        panel.grid.major.x = element_blank(),
        axis.title = element_text(size=10),
        axis.title.y = element_blank(),
        axis.text.y = element_text(size=12),
        axis.text.x = element_text(face = "bold",size = 11),
        plot.title = element_text(size=11))


```



# Uma escolha difícil?

Neste novo eixo de polarização, a <yt>exposição à morte importa</yt>. 

- Tanto no isolamento

- Quanto na posição em relação aos políticos

O medo da morte é tão grande que relativiza as outras dimensões

## oncordância com Isolamento por negócio e risco {.center}
```{r,fig.height=7}

# C
sct3 <- drt.df %>%
  ggplot(aes(y=as.numeric(favor_isol),
                 x=prejuizo,
              #   shape=gruporisco,
                 color=coron_cat,
              group=gruporisco
              )) +
  geom_point(position = position_jitter(width = .15), 
             size = 1,alpha=.3) + 
  geom_smooth(method="lm",aes(group=coron_cat,fill=coron_cat),
             # se=F,
              lwd=1,alpha=0.2) +
  scale_color_manual(values = paleta) +
  scale_fill_manual(values = paleta) +
  scale_y_continuous(breaks = c(1,3,5),
                     labels=c("Discorda","Indiferente","Concorda"),
                     expand = expansion(0)) +
  scale_x_discrete(expand = expansion(0)) +
  labs(y="Isolamento social",x="Prejuízo econômico pessoal",
       color="Conhecimento sobre pessoas infectadas",fill="") +
  guides(color=guide_legend(title.position = "top",nrow = 1),
         fill=F) +
#    theme_ridges() +
  dark_theme_minimal() +
  theme(legend.position = "bottom",
        legend.text = element_text(size=12),
        legend.title = element_text(size=13,face="bold"),
        axis.title = element_text(size=10,face="bold"),
        axis.text = element_text(size=12),
        plot.title = element_text(size=11))


sct3 * theme(axis.text = element_text(size = 12),
             axis.text.y = element_text(angle=90),
             plot.background = element_rect(color= NA),
             panel.background = element_rect(color = NA),
             panel.border = element_blank(),
             axis.title = element_text(hjust = 1),
                   text = element_text(family = "Lato"))

```

## Concordância com Bolsonaro por consequências econômicas e risco {.center}

```{r}
# # 
sct1 <- drt.df %>%
#df %>%  dplyr::filter(ideologia<4) %>%
  ggplot(aes(y=as.numeric(trabbolso),
                 x=prejuizo,
              #   shape=gruporisco,
                 color=coron_cat,
              group=gruporisco
              )) +
  geom_point(position = position_jitter(width = .15), 
             size = 1,alpha=.3) + 
  geom_smooth(method="lm",aes(group=coron_cat,fill=coron_cat),
             # se=F,
              lwd=1) +
  scale_color_manual(values = rev(paleta)) +
  scale_fill_manual(values = rev(paleta)) +
  scale_y_continuous(breaks = c(1,3,5),
                     labels=c("Discorda","Indiferente","Concorda")) +
  labs(y="Ações do Presidente",x="Prejuízo econômico pessoal",
       color="Conhecimento sobre pessoas infectadas",fill="") +
  guides(color=guide_legend(title.position = "top",nrow = 1),
         fill=F) +
#    theme_ridges() +
  dark_theme_minimal() +
  theme(legend.position = "none",
        legend.text = element_text(size=8),
        legend.title = element_text(size=10,face="bold"),
        axis.title = element_text(size=10,face="bold"),
        axis.text = element_text(size=9),
        plot.title = element_text(size=11))
sct1 <- sct1 + theme(legend.position = "bottom")

sct1 * theme(axis.text = element_text(size = 12),
             axis.text.y = element_text(angle=90),
             plot.background = element_rect(color= NA),
             panel.background = element_rect(color = NA),
             panel.border = element_blank(),
             axis.title = element_text(hjust = 1),
                   text = element_text(family = "Lato"))
```


